<style>
    .collapsed {
        display: none;
    }

    .mt-content-container #mt-toc-container {
        position: fixed;
        right: 10px;
        top: 10px;
    }

    #mt-toc-container.collapsed {
        display: none;
    }

    /* Oculta el ::before de los <li> que tienen un <ol> como hijo directo  */
    .mt-content-container #mt-toc-container>ol>li::before {
        display: none !important;
    }
</style>

<script>
    function esconderIndiceIntegracion() {
        window.addEventListener('load', function () {
            setTimeout(function () {
                if (window.location.href.startsWith('https://osde-prod2.mindtouch.us/')) {
                    const indiceIntegracion = document.querySelector('.indiceIntegracion');
                    if (indiceIntegracion) {
                        indiceIntegracion.style.display = 'none';
                        console.log('El elemento .indiceIntegracion se oculto correctamente.');
                    } else {
                        console.log('No se encontro el elemento .indiceIntegracion en el documento.');
                    }
                } else {
                    console.log('La URL no coincide con "https://osde-prod2.mindtouch.us/".');
                }
            }, 500);
        });
    }
    esconderIndiceIntegracion();
</script>

<script>
    window.addEventListener('load', function () {

        function encodeSpecialCharacters(text) {
            return text.replace(/[áÁ]/g, '.C3.A1') // Reemplaza 'á' y 'Á' por '.C3.A1'
                .replace(/[éÉ]/g, '.C3.A9') // Reemplaza 'é' y 'É' por '.C3.A9'
                .replace(/[íÍ]/g, '.C3.AD') // Reemplaza 'í' y 'Í' por '.C3.AD'
                .replace(/[óÓ]/g, '.C3.B3') // Reemplaza 'ó' y 'Ó' por '.C3.B3'
                .replace(/[úÚ]/g, '.C3.BA') // Reemplaza 'ú' y 'Ú' por '.C3.BA'
                .replace(/\(/g, '.28') // Reemplaza paréntesis de apertura '(' por '.28'
                .replace(/\)/g, '.29') // Reemplaza paréntesis de cierre ')' por '.29'
                .replace(/\n/g, '.0A____________') // Reemplaza saltos de línea '\n' por '.0A____________'
                .replace(/\s+/g, '_'); // Reemplaza espacios ' ' por '_'
        }
        const contenedorPrincipal = document.querySelector('.mt-content-container');
        const divTocContenedor = document.createElement('div');
        divTocContenedor.id = 'mt-toc-container';
        divTocContenedor.dataset.title = 'Índice';
        divTocContenedor.dataset.collapsed = 'false';
        divTocContenedor.className = 'mt-toggle-container indiceIntegracion';
        const tocLista = document.createElement('ol');
        tocLista.className = 'mt-toc-content mt-collapsible-section';
        divTocContenedor.appendChild(tocLista);
        const encabezadosH2 = contenedorPrincipal.querySelectorAll('h2');
        encabezadosH2.forEach((encabezadoH2) => {
            const tocLiH2 = document.createElement('li');
            const tocLinkH2 = document.createElement('a');
            tocLinkH2.rel = 'internal';
            tocLinkH2.textContent = encabezadoH2.textContent.trim();
            const enlaceTextoH2 = encodeSpecialCharacters(encabezadoH2.textContent.trim().replace(
                /\s+/g, '_'));
            tocLinkH2.href = `#${enlaceTextoH2}`;
            tocLiH2.appendChild(tocLinkH2);
            const encabezadosH3 = encabezadoH2.parentNode.querySelectorAll('h3');
            if (encabezadosH3.length > 0) {
                const flechaH2 = document.createElement('img');
                flechaH2.classList.add('imgFlechaIndice');
                flechaH2.style.marginLeft = "10px";
                flechaH2.src = '/@api/deki/files/22/downArrowBlue.png.png';
                flechaH2.alt = 'Flecha';
                tocLiH2.appendChild(flechaH2);
                const listaHermanosH2 = document.createElement('ol');
                listaHermanosH2.classList.add('collapsed');
                encabezadosH3.forEach((encabezadoH3) => {
                    const tocLiH3 = document.createElement('li');
                    const tocLinkH3 = document.createElement('a');
                    tocLinkH3.rel = 'internal';
                    tocLinkH3.textContent = encabezadoH3.textContent.trim();
                    const enlaceTextoH3 = encodeSpecialCharacters(encabezadoH3.textContent
                        .trim().replace(/\s+/g, '_'));
                    tocLinkH3.href = `#${enlaceTextoH3}`;
                    tocLiH3.appendChild(tocLinkH3);
                    listaHermanosH2.appendChild(tocLiH3);
                });
                tocLiH2.appendChild(listaHermanosH2);
                flechaH2.addEventListener('click', function () {
                    listaHermanosH2.classList.toggle('collapsed');
                    flechaH2.src = listaHermanosH2.classList.contains('collapsed') ?
                        '/@api/deki/files/22/downArrowBlue.png.png' :
                        '/@api/deki/files/101/upArrowBlue.png';
                });
            }
            tocLista.appendChild(tocLiH2);
        });
        contenedorPrincipal.insertBefore(divTocContenedor, contenedorPrincipal.firstChild);
        tocLista.addEventListener('click', function (event) {
            if (event.target.tagName === 'A') {
                event.preventDefault();
                const enlace = event.target;
                const idEncabezado = enlace.getAttribute('href').substring(1);
                const encabezadoDestino = document.getElementById(idEncabezado);
                const posicionElemento = encabezadoDestino.offsetTop;
                const desplazamiento = posicionElemento + 0;
                window.scrollTo({
                    top: desplazamiento,
                    behavior: 'smooth'
                });
            }
        });

        const botonColapso = document.createElement('button');
        botonColapso.className = 'mt-toggle mt-summary-toggle ui-button-icon mt-toggle-collapse';
        botonColapso.type = 'button';
        botonColapso.textContent = 'Índice';
        divTocContenedor.insertBefore(botonColapso, tocLista);

        botonColapso.addEventListener('click', function () {
            divTocContenedor.classList.toggle('collapsed');
            tocLista.classList.toggle('collapsed');
            botonColapso.className = divTocContenedor.classList.contains('collapsed') ? 'mt-toggle mt-summary-toggle ui-button-icon mt-toggle-expand' :
                'mt-toggle mt-summary-toggle ui-button-icon mt-toggle-collapse';
        });
    });
</script>